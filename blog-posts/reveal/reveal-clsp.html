<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="In-depth article about SAP EWM. Learn technical and functional details about [Topic].">
    <meta name="keywords" content="SAP EWM, Warehouse Management, [Topic Keywords]">
    <meta name="author" content="Hendrik">
    <link rel="icon" type="image/png" href="/assets/favicon/wmexperts%20favicon.png">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Article Title | WMexperts">
    <meta property="og:description" content="In-depth article about SAP EWM. Learn technical and functional details about [Topic].">
    <meta property="article:published_time" content="2024-10-05">
    <meta property="article:modified_time" content="2024-10-05">

    <!-- Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "BlogPosting",
  "headline": "Article Title",
  "description": "In-depth article about SAP EWM. Learn technical and functional details about [Topic].",
  "image": "../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_01.png",
  "datePublished": "2024-10-05T00:00:00Z",
  "dateModified": "2024-10-05T00:00:00Z",
  "author": {
    "@type": "Person",
    "name": "Hendrik"
  },
  "publisher": {
    "@type": "Organization",
    "name": "WMexperts",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wmexperts.online/assets/favicon/favicon-32x32.png"
    }
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://wmexperts.online/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Reveal SAP EWM",
      "item": "https://wmexperts.online/blog-posts/reveal/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Article Title",
      "item": "https://wmexperts.online/blog-posts/reveal/reveal-clsp.html"
    }
  ]
}
</script>

    <title>Article Title | WMexperts</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>

    <header id="main-header"></header>

    <article>
        <div class="breadcrumb">Reveal SAP EWM</div>
        <h1>Storage bin sorting during putaway (CLSP)</h1>

        <div class="video-wrapper">
            <iframe src="https://www.youtube-nocookie.com/embed/Qs5Nl9Xg2yQ" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>

        <div class="content">
            <p>This blog is supposed to clear up one of the biggest misconceptions in the context of bin determination during putaway task creation in SAP EWM.</p>
            <p>Before we jump into the system, let us quickly make sure to understand the scenario from material flow / process perspective –<br>Imagine you want to putaway a handling unit – let us assume a pallet loaded with some cartons – into a pallet rack. You have defined a strategy to determine an empty bin. All bins have the same bin type. So far so good. However, there might be lots of empty bins in the given rack. So how should EWM now decide which bin to suggest for the putaway process?</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_01.png" alt="SAP EWM storage bin sorting CLSP_01" width="1024" height="617" loading="lazy">
            </div>
            
            <p>At this point, the bin sorting comes into the game!</p>
            <p>I will explain the topic for you based on the following <strong>agenda</strong>:</p>
            <ul>
                <li>The standard logic</li>
                <li>The configuration</li>
                <li>The bin sorting</li>
                <li>The coding</li>
                <li>Options for enhancement</li>
            </ul>
            
            <p>As a starting point it is important to understand that whenever EWM is sorting something based on storage bins (e.g. warehouse tasks within warehouse orders, bins during putaway etc.) it is using so called ‘sort sequence numbers’. Those numbers are assigned to storage bins. EWM never uses those sequence numbers alone. It usually uses a combination of a sequence number along with an activity area and an activity type. Different combinations of activities, activity areas and sequence numbers can be attached to storage bins. Either based on the execution of a report (which is reading the sorting logic from the customizing) or based on an excel upload file.</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_02.png" alt="SAP EWM storage bin sorting CLSP_02" width="1024" height="547" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_03.png" alt="SAP EWM storage bin sorting CLSP_03" width="837" height="789" loading="lazy">
            </div>
            
            <p>The result with both options is saved in table <code>/SCWM/LAGPS</code>. I highlighted the important fields within the screenshot below:The following activities can be used to attach a sort sequence number to a storage bin in EWM standard:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_05.png" alt="SAP EWM storage bin sorting CLSP_05" width="1024" height="433" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_04.png" alt="SAP EWM storage bin sorting CLSP_04" width="1024" height="513" loading="lazy">
            </div>
            
            <p>Based on this it seems to be obvious to sort bins based on the activity type ‘<code>PTWY</code> – Putaway’ in order to sort bins for the putaway process scenario described at the beginning of this post. Far from it!<br>The sequence numbers assigned to the bins for activity type ‘<code>PTWY</code>’ is only used for the sorting of putaway warehouse tasks within warehouse orders (e.g. for travel path optimization in case you assign multiple warehouse tasks for putaway to one warehouse order). It is not used to sort bins during the actual determination of the destination bin. EWM indeed uses the sequence number for this activity type during putaway task creation but only after the destination bin has already been determined (we will come back to this point later again!).<br>So if it is not the activity type <code>PTWY</code>, what else is being used in order to sort the bins during the destination bin determination for our example above? The answer to this question is the assignment of the combination of sort sequence numbers, activity area and the activity type ‘<code>CLSP</code> – Cross-Line Stock Putaway’ to the given bins.</p>
            
            <strong>The configuration</strong>
            <p>The creation of the activity area and its sorting can be done here:</p>
            <ul>
                <li>Define an activity area via <code>SPRO</code>: <em>SCWM Extended Warehouse Management -&gt; Extended Warehouse Management -&gt; Master Data -&gt; Activities Areas -&gt; Define Activity Areas</em></li>
                <li>Then assign this Activity Area to storage type. Path in <code>SPRO</code>: <em>SCWM Extended Warehouse Management -&gt; Extended Warehouse Management -&gt; Master Data -&gt; Activities Areas -&gt; Assign Storage Bins to Activity Areas</em></li>
                <li>Then define sort sequence for <code>CLSP</code> Activity. Path in <code>SPRO</code>: <em>SCWM Extended Warehouse Management -&gt; Extended Warehouse Management -&gt; Master Data -&gt; Activities Areas -&gt; Define Sort Sequence for Cross-Line Stock Putaway</em></li>
            </ul>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_06.png" alt="SAP EWM storage bin sorting CLSP_06" width="1024" height="559" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_07.png" alt="SAP EWM storage bin sorting CLSP_07" width="1024" height="275" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_08.png" alt="SAP EWM storage bin sorting CLSP_08" width="1024" height="320" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_09.png" alt="SAP EWM storage bin sorting CLSP_09" width="1024" height="117" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_10.png" alt="SAP EWM storage bin sorting CLSP_10" width="732" height="437" loading="lazy">
            </div>
            
            <p>Here you can now provide a logic for the assignment of the sequence numbers for sorting. For aisle, stack, level and subdivision you can decide whether you want to sort ascending or descending as well as whether you want to alternate or not.<br>An example for the sort sequence between the 3 parameters is visualized in the screenshot below. Here I sorted 1st based on the stack and 2nd based on the level. You can see that EWM will first assign sequence numbers to all stacks of a given level before it proceeds with all stacks for the next level. This screenshot also shows how the ‘alternating’ approach is supposed to work. You can see that EWM counts the stack up until the max value and then decreases again from there for the next level. When you set this to ‘not alternating’ it would start again from the lowest stack value:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_11.png" alt="SAP EWM storage bin sorting CLSP_11" width="847" height="788" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_12.png" alt="SAP EWM storage bin sorting CLSP_12" width="871" height="858" loading="lazy">
            </div>
            
            <p>Here another example where I sorted 1st based on the level and 2nd based on the stack:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_13.png" alt="SAP EWM storage bin sorting CLSP_13" width="818" height="753" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_14.png" alt="SAP EWM storage bin sorting CLSP_14" width="831" height="820" loading="lazy">
            </div>
            
            <p>For all activities other than <code>CLSP</code>, EWM is sorting the aisles one-by-one. Only for <code>CLSP</code> it always sorts based on the aisle first. Another example to help you understand this approach along with the options for alternating:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_15.png" alt="SAP EWM storage bin sorting CLSP_15" width="1024" height="571" loading="lazy">
            </div>
            
            <p><u>Note</u>: If you leave all other fields blank, the system simply sorts in ascending order based on the storage bin names.<br>In addition to this, you have a parameter to fix the sorting. You can use this checkbox to ensure that the sorting is not changed during picking with radio frequency (RF). If you select this checkbox, it is not possible for the operator to change the path sequence during picking.</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_16.png" alt="SAP EWM storage bin sorting CLSP_16" width="1024" height="145" loading="lazy">
            </div>
            
            <p>And that is it for this post! Pretty sure most of you are already using one or the other tool that I presented here. I hope that some of you still found something new here that helps you during your daily tasks in the future!</p>
            
            <strong>The bin sorting</strong>
            <p>Once the customizing is completed as shown above, the bins have to be sorted via transaction <code>/SCWM/SBST</code>:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_17.png" alt="SAP EWM storage bin sorting CLSP_17" width="1024" height="343" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_18.png" alt="SAP EWM storage bin sorting CLSP_18" width="1024" height="357" loading="lazy">
            </div>
            
            <p>Once the sorting has been executed, the sequence numbers are saved in table <code>/SCWM/LAGPS</code> as well as <code>/SCWM/LAGP</code>. This is also different compared to other activities where the sorting is only saved in the <code>/SCWM/LAGPS</code> table. Could not find the reason why we have it in two tables honestly. Maybe anyone has a good idea!?</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_19.png" alt="SAP EWM storage bin sorting CLSP_19" width="1024" height="427" loading="lazy">
            </div>
            
            <strong>The coding</strong>
            <p>It is interesting to observe that the although activity <code>CLSP</code> is not given as activity type in the customizing of the warehouse process type, it is still used for the sorting in our scenario:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_20.png" alt="SAP EWM storage bin sorting CLSP_20" width="1024" height="586" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_21.png" alt="SAP EWM storage bin sorting CLSP_21" width="1024" height="513" loading="lazy">
            </div>
            
            <p>Seems SAP noticed at some point that the WPT parameter is required for the activity which is used for the sorting within the WO (mentioned at the beginning of this post) and thus, needed a different approach to determine the sequence for the bin selection.<br>For non-MFS storage types the sorting is done in include <code>/SCWM/LPUT_BIN_DETF77</code>, subroutine <code>SORT_EMPTY_BINS</code>, right after a list of possible destination bins had been determined via the subroutines <code>BIN_DETERMINATION_1</code> & *2 in include <code>/SCWM/LPUT_BIN_DETF17</code>/ <code>/SCWM/LPUT_BIN_DETF26</code>. This is at least true for the empty bin determination. I have to admit that I did not spend time on analyzing the exact spot for addition to stock. However, I am pretty sure the function module which is finally used for the actual sorting is the same for both cases (so if you want to debug your specific strategy, just put a breakpoint into this one): <code>/SCWM/ACT_AREA_EVALUATE</code><br>The FM imports the table of unsorted bins, reads the bin sorting against the imported activity type from the tables listed at the beginning of this article and exports a table with the same bins sorted accordingly:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_22.png" alt="SAP EWM storage bin sorting CLSP_22" width="1024" height="696" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_23.png" alt="SAP EWM storage bin sorting CLSP_23" width="1024" height="646" loading="lazy">
            </div>
            
            <p>…to be honest – I do not understand why the standard is coded like this. In line 26 it uses a constant to set the activity for our context. Then it fills <code>lt_lgpla_unsorted</code> from imported table <code>IT_ILAGPL</code> just to sort <code>lt_lgpla_unsorted</code> within the FM <code>/SCWM/ACT_AREA_EVALUATE</code> based on activity <code>CLSP</code>. However, the internal table that was imported to our subroutine here already had the field <code>CLSP_SORT</code>:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_24.png" alt="SAP EWM storage bin sorting CLSP_24" width="1024" height="391" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_25.png" alt="SAP EWM storage bin sorting CLSP_25" width="1024" height="771" loading="lazy">
            </div>
            
            <p>So why not just sort table <code>IT_ILAGPL</code> based on this field in line 32 ff. and return from the subroutine instead of calling FM <code>/SCWM/ACT_AREA_EVALUATE</code>?<br>A big beer on my bill for anyone who can explain to me why this would not work!<br>The logic for MFS storage types is less complex. Method <code>/SCWM/CL_CORE_PUTSTRA-DET_EMPTY_BIN</code> sorts the internal table of bins. As mentioned above, the field <code>CLSP_SORT</code> already exists in the <code>/SCWM/LAGP</code> table and here EWM does what I suggested above. The sequence number is read along with the bin and so does not have to be re-determined with an additional FM:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_26.png" alt="SAP EWM storage bin sorting CLSP_26" width="1024" height="496" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_27.png" alt="SAP EWM storage bin sorting CLSP_27" width="1024" height="243" loading="lazy">
            </div>
            
            <p>Now that we understood how the sorting during bin determination works based on the <code>CLSP</code> sequence, let us have a quick look at the technical details about the logic to sort WTs within WOs based on the <code>PTWY</code> sequence.<br>Once the destination bin for a given WT has been determined (like described above), EWM fills the field <code>PATHSEQ</code> in the <code>/SCWM/ORDIM_O</code> table.<br>It determines the sequence number based on the activity of the WPT (which is ‘<code>PTWY</code>’ for putaway processes):</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_28.png" alt="SAP EWM storage bin sorting CLSP_28" width="1024" height="251" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_29.png" alt="SAP EWM storage bin sorting CLSP_29" width="1024" height="547" loading="lazy">
            </div>
            
            <p>The determination of the sequence number is done via FM <code>/SCWM/LAGPS_READ_SINGLE</code>, called from <code>/SCWM/TO_ACT_AREA_DET</code> --&gt; <code>/SCWM/ACT_AREA_EVALUATE</code>:<br>The sorting in the context of warehouse order creation is done in include <code>/SCWM/LWHO_MAINF03</code>, subroutine <code>who_to_sort</code>. EWM is considering the <code>PATHSEQ</code> field by default in case you do not specify a sort rule. However, you can also consider this field along with a list of other sort criteria within your customized sort sequence:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_30.png" alt="SAP EWM storage bin sorting CLSP_30" width="1024" height="697" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_31.png" alt="SAP EWM storage bin sorting CLSP_31" width="1024" height="734" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_32.png" alt="SAP EWM storage bin sorting CLSP_32" width="1024" height="270" loading="lazy">
            </div>
            
            <p>This sorting is not mandatory though. You could also create such warehouse orders without having any <code>PTWY</code> sorting in place.<br>The following flow-chart should visualize and summarize what we’ve learned so far:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_33.png" alt="SAP EWM storage bin sorting CLSP_33" width="1024" height="448" loading="lazy">
            </div>
            
            <strong>Options for enhancements</strong>
            <p>As you know it from my previous blog posts, I use to give you some options to enhance the standard logic. This section is limited to the sorting of bins during the determination of the destination. Enhancements of the sorting within the WOs is not in scope here. You can look into this blog post in case you want to learn more about enhancing the WOCRs.</p>
            <p>Badi <code>/SCWM/EX_CORE_PTS_FILT_SORT</code> is one that will work here for sure, as the name already suggests:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_34.png" alt="SAP EWM storage bin sorting CLSP_34" width="1024" height="530" loading="lazy">
            </div>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_35.png" alt="SAP EWM storage bin sorting CLSP_35" width="1024" height="615" loading="lazy">
            </div>
            
            <p>It is called right after EWM has determined a list of possible destination bins for a given WT and saved those in an internal table (as mentioned above, this is done in include <code>/SCWM/LPUT_BIN_DETF77</code>, subroutine <code>SORT_EMPTY_BINS</code>):<br>The interface allows to change the sorting within this table of possible destination tasks:</p>
            
            <div class="screenshot-container">
                <img src="../../assets/images/reveal/clsp/SAP EWM storage bin sorting CLSP_36.png" alt="SAP EWM storage bin sorting CLSP_36" width="1024" height="369" loading="lazy">
            </div>
            
            <p>EWM delivers a sample implementation which might give you some good ideas about how to implement a custom sorting here (class <code>/SCWM/CL_EI_CORE_PTS_FILT_SORT</code>).</p>
            
            <strong>Final thoughts &amp; remarks</strong>
            <ul>
                <li>The sort sequence number for <code>CLSP</code> is only relevant in case multiple bins are available with the same characteristics related to your putaway strategy. EWM first determines optimal bins e.g. based on the bin type and/or the storage section. Only if multiple valid bins exist with the optimal combination, the sequence numbers for <code>CLSP</code> sorting are applied</li>
                <li>You might have noticed that if you do not create the activity area and the sorting for the <code>CLSP</code> activity at all, you will still get a destination bin during putaway task creation. In this case, EWM will simply sort the bins by their names.</li>
                <li>Seems SAP also noticed that the topic is quite confusing. They released note 2992048 but you do not need to read that once you’ve read and understand this blog post :-)</li>
            </ul>
            
            <p>…and here we are again at the end of the article. The intention of this blog post was to shed some light and help you to avoid confusion around this topic. Hope I could provide some value for one or the other!</p>
            
        </div>

        <!-- STAY UPDATED SECTION -->
        <div class="stay-updated">
            <!-- Newsletter Card -->
            <div class="stay-updated-card">
                <div>
                    <h3>📧 Newsletter</h3>
                    <p>Get updates about new blog posts directly in your inbox.</p>
                </div>
                <form action="https://online.us17.list-manage.com/subscribe/post?u=3dbafeb5441a290b4bfdeeb38&id=226759b4e6&f_id=00e24be0f0" method="post" class="newsletter-form" target="_blank" rel="noopener noreferrer">
                    <input type="email" name="EMAIL" placeholder="Your email" required>
                    <input type="text" name="FNAME" placeholder="First name">
                    <input type="text" name="LNAME" placeholder="Last name">
                    <input type="text" name="b_3dbafeb5441a290b4bfdeeb38_226759b4e6" style="display: none;" tabindex="-1">
                    <button type="submit" class="btn-subscribe">Subscribe</button>
                </form>
            </div>

            <!-- YouTube Card -->
            <div class="stay-updated-card">
                <div>
                    <h3>▶️ YouTube Channel</h3>
                    <p>Subscribe to my channel for regular tutorials & insights about SAP EWM.</p>
                </div>
                <a href="https://www.youtube.com/@sapewm?sub_confirmation=1" target="_blank" rel="noopener noreferrer" class="btn-youtube" >Subscribe on YouTube</a>
            </div>
        </div>

        <!-- FREELANCER CTA (Commented out - to be launched later)
        <section class="freelancer-cta" aria-labelledby="cta-heading">
            <h2 id="cta-heading">Need Support around SAP EWM?</h2>
            <p>WMexperts.online is the knowledge hub of Hendrik, a Senior SAP EWM Consultant with expertise in functional design, technical implementation, and project leadership.</p>
            <a href="#" class="btn-primary">Explore My Offerings →</a>
        </section>
        -->
    </article>

    <!-- ENHANCED LIGHTBOX OVERLAY -->
    <div id="lightbox">
        <span class="lightbox-close" id="lightbox-close">&times;</span>
        <span class="lightbox-prev" id="lightbox-prev">&#8249;</span>
        <span class="lightbox-next" id="lightbox-next">&#8250;</span>
        <div class="lightbox-content">
            <img id="lightbox-img" src="" alt="">
        </div>
        <div class="lightbox-counter" id="lightbox-counter"></div>
    </div>

    <footer id="main-footer"></footer>

    <!-- ENHANCED LIGHTBOX JAVASCRIPT -->
    <script>
        (function() {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            const lightboxClose = document.getElementById('lightbox-close');
            const lightboxPrev = document.getElementById('lightbox-prev');
            const lightboxNext = document.getElementById('lightbox-next');
            const lightboxCounter = document.getElementById('lightbox-counter');
            
            // Get all images that should be zoomable
            const images = document.querySelectorAll('.screenshot-container img, .content img');
            let currentImageIndex = 0;

            // Add click event to all images
            images.forEach((img, index) => {
                img.addEventListener('click', function() {
                    openLightbox(index);
                });
            });

            function openLightbox(index) {
                currentImageIndex = index;
                lightboxImg.src = images[currentImageIndex].src;
                lightboxImg.alt = images[currentImageIndex].alt;
                lightbox.classList.add('active');
                document.body.classList.add('lightbox-open');
                updateCounter();
                
                // Show/hide navigation arrows based on number of images
                if (images.length <= 1) {
                    lightboxPrev.style.display = 'none';
                    lightboxNext.style.display = 'none';
                } else {
                    lightboxPrev.style.display = 'block';
                    lightboxNext.style.display = 'block';
                }
            }

            function closeLightbox() {
                lightbox.classList.remove('active');
                document.body.classList.remove('lightbox-open');
            }

            function showPrevImage() {
                currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
                lightboxImg.src = images[currentImageIndex].src;
                lightboxImg.alt = images[currentImageIndex].alt;
                updateCounter();
            }

            function showNextImage() {
                currentImageIndex = (currentImageIndex + 1) % images.length;
                lightboxImg.src = images[currentImageIndex].src;
                lightboxImg.alt = images[currentImageIndex].alt;
                updateCounter();
            }

            function updateCounter() {
                if (images.length > 1) {
                    lightboxCounter.textContent = `${currentImageIndex + 1} / ${images.length}`;
                    lightboxCounter.style.display = 'block';
                } else {
                    lightboxCounter.style.display = 'none';
                }
            }

            // Event listeners
            lightboxClose.addEventListener('click', function(e) {
                e.stopPropagation();
                closeLightbox();
            });

            lightboxPrev.addEventListener('click', function(e) {
                e.stopPropagation();
                showPrevImage();
            });

            lightboxNext.addEventListener('click', function(e) {
                e.stopPropagation();
                showNextImage();
            });

            // Click on overlay background to close
            lightbox.addEventListener('click', function(e) {
                if (e.target === lightbox) {
                    closeLightbox();
                }
            });

            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (!lightbox.classList.contains('active')) return;
                
                if (e.key === 'Escape') {
                    closeLightbox();
                } else if (e.key === 'ArrowLeft') {
                    showPrevImage();
                } else if (e.key === 'ArrowRight') {
                    showNextImage();
                }
            });

            // Prevent image content click from closing lightbox
            lightboxImg.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        })();
    </script>

    <script>
    // Load global components
    fetch('/header-content.html').then(res => res.text()).then(html => document.getElementById('main-header').innerHTML = html);
    fetch('/footer-content.html').then(res => res.text()).then(html => document.getElementById('main-footer').innerHTML = html);
    </script>

</body>
</html>






